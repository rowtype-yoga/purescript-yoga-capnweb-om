// Generated by purs version 0.15.15
import * as Control_Alt from "../Control.Alt/index.js";
import * as Control_Applicative from "../Control.Applicative/index.js";
import * as Control_Bind from "../Control.Bind/index.js";
import * as Control_Monad_Reader_Class from "../Control.Monad.Reader.Class/index.js";
import * as Data_Array from "../Data.Array/index.js";
import * as Data_Eq from "../Data.Eq/index.js";
import * as Data_EuclideanRing from "../Data.EuclideanRing/index.js";
import * as Data_Maybe from "../Data.Maybe/index.js";
import * as Data_Semigroup from "../Data.Semigroup/index.js";
import * as Data_Show from "../Data.Show/index.js";
import * as Data_Time_Duration from "../Data.Time.Duration/index.js";
import * as Data_Tuple from "../Data.Tuple/index.js";
import * as Data_Unit from "../Data.Unit/index.js";
import * as Effect_Aff from "../Effect.Aff/index.js";
import * as Effect_Class_Console from "../Effect.Class.Console/index.js";
import * as Effect_Exception from "../Effect.Exception/index.js";
import * as Yoga_Om from "../Yoga.Om/index.js";
import * as Yoga_Om_Error from "../Yoga.Om.Error/index.js";
import * as Yoga_Om_Strom from "../Yoga.Om.Strom/index.js";
var log = /* #__PURE__ */ Effect_Class_Console.log(Effect_Aff.monadEffectAff);
var bind = /* #__PURE__ */ Control_Bind.bind(Effect_Aff.bindAff);
var runOm = /* #__PURE__ */ Yoga_Om.runOm()()();
var discard = /* #__PURE__ */ Control_Bind.discard(Control_Bind.discardUnit);
var discard1 = /* #__PURE__ */ discard(Effect_Aff.bindAff);
var show = /* #__PURE__ */ Data_Show.show(Effect_Exception.showError);
var pure = /* #__PURE__ */ Control_Applicative.pure(Effect_Aff.applicativeAff);
var bind1 = /* #__PURE__ */ Control_Bind.bind(Yoga_Om.bindOm);
var discard2 = /* #__PURE__ */ discard(Yoga_Om.bindOm);
var delay = /* #__PURE__ */ Yoga_Om.delay(Yoga_Om.monadAffOm)(Data_Time_Duration.durationMilliseconds);
var pure1 = /* #__PURE__ */ Control_Applicative.pure(Yoga_Om.applicativeOm);
var show1 = /* #__PURE__ */ Data_Show.show(Data_Show.showInt);
var ask = /* #__PURE__ */ Control_Monad_Reader_Class.ask(Yoga_Om.monadAskOm);
var show2 = /* #__PURE__ */ Data_Show.show(/* #__PURE__ */ Data_Show.showArray(Data_Show.showString));
var alt = /* #__PURE__ */ Control_Alt.alt(Yoga_Om_Strom.altStrom);
var $$throw = /* #__PURE__ */ Yoga_Om["throw"](/* #__PURE__ */ Yoga_Om_Error.singletonVariantRecord()()()({
    reflectSymbol: function () {
        return "networkError";
    }
}))(Yoga_Om.monadThrowVariantExceptio);
var bind2 = /* #__PURE__ */ Control_Bind.bind(Yoga_Om_Strom.bindStrom1);
var mod = /* #__PURE__ */ Data_EuclideanRing.mod(Data_EuclideanRing.euclideanRingInt);
var NetworkError = /* #__PURE__ */ (function () {
    function NetworkError() {

    };
    NetworkError.value = new NetworkError();
    return NetworkError;
})();
var ValidationError = /* #__PURE__ */ (function () {
    function ValidationError() {

    };
    ValidationError.value = new ValidationError();
    return ValidationError;
})();
var TimeoutError = /* #__PURE__ */ (function () {
    function TimeoutError() {

    };
    TimeoutError.value = new TimeoutError();
    return TimeoutError;
})();
var runExampleWithLogger = function (dictShow) {
    var show3 = Data_Show.show(dictShow);
    return function (om) {
        var ctx = {
            logger: function (msg) {
                return log(msg);
            }
        };
        return bind(runOm(ctx)({
            exception: function (err) {
                return discard1(log("Error: " + show(err)))(function () {
                    return pure(Data_Unit.unit);
                });
            }
        })(bind1(om)(function (a) {
            return Yoga_Om.fromAff(log(show3(a)));
        })))(function (result) {
            return pure(result);
        });
    };
};
var runExample = function (dictShow) {
    var show3 = Data_Show.show(dictShow);
    return function (om) {
        return bind(runOm({})({
            exception: function (err) {
                return discard1(log("Error: " + show(err)))(function () {
                    return pure(Data_Unit.unit);
                });
            }
        })(bind1(om)(function (a) {
            return Yoga_Om.fromAff(log(show3(a)));
        })))(function (result) {
            return pure(result);
        });
    };
};
var parseNumbers = function (v) {
    if (v === "one") {
        return new Data_Maybe.Just(1);
    };
    if (v === "two") {
        return new Data_Maybe.Just(2);
    };
    if (v === "three") {
        return new Data_Maybe.Just(3);
    };
    return Data_Maybe.Nothing.value;
};
var fibonacciStream = /* #__PURE__ */ (function () {
    return Yoga_Om_Strom.unfoldStrom(function (v) {
        return new Data_Maybe.Just(new Data_Tuple.Tuple(v.value0, new Data_Tuple.Tuple(v.value1, v.value0 + v.value1 | 0)));
    })(new Data_Tuple.Tuple(0, 1));
})();
var fetchUser = function (id) {
    return discard2(delay(100.0))(function () {
        return pure1("User #" + show1(id));
    });
};
var fetchPage = function (token) {
    return discard2(delay(100.0))(function () {
        var $83 = token === "start";
        if ($83) {
            return pure1({
                items: [ "item1", "item2" ],
                nextToken: new Data_Maybe.Just("page2")
            });
        };
        var $84 = token === "page2";
        if ($84) {
            return pure1({
                items: [ "item3", "item4" ],
                nextToken: new Data_Maybe.Just("page3")
            });
        };
        var $85 = token === "page3";
        if ($85) {
            return pure1({
                items: [ "item5" ],
                nextToken: Data_Maybe.Nothing.value
            });
        };
        return pure1({
            items: [  ],
            nextToken: Data_Maybe.Nothing.value
        });
    });
};
var example9 = /* #__PURE__ */ (function () {
    var users = [ {
        id: 1,
        name: "Alice",
        active: true
    }, {
        id: 2,
        name: "Bob",
        active: false
    }, {
        id: 3,
        name: "Charlie",
        active: true
    }, {
        id: 4,
        name: "Dave",
        active: true
    }, {
        id: 5,
        name: "Eve",
        active: false
    } ];
    return Yoga_Om_Strom.traverseStrom_(function (batch) {
        return bind1(ask)(function (v) {
            return Yoga_Om.fromAff(v.logger("Saving batch: " + show2(batch)));
        });
    })(Yoga_Om_Strom.mapStrom(function (x) {
        return [ x ];
    })(Yoga_Om_Strom.mapMStrom(function (user) {
        return discard2(delay(50.0))(function () {
            return pure1(user.name + (" (ID: " + (show1(user.id) + ")")));
        });
    })(Yoga_Om_Strom.tapMStrom(function (user) {
        return bind1(ask)(function (v) {
            return Yoga_Om.fromAff(v.logger("Processing active user: " + user.name));
        });
    })(Yoga_Om_Strom.filterStrom(function (v) {
        return v.active;
    })(Yoga_Om_Strom.fromArray(users))))));
})();
var example8 = /* #__PURE__ */ Yoga_Om_Strom.runCollect(/* #__PURE__ */ Yoga_Om_Strom.changesStrom(Data_Eq.eqInt)(/* #__PURE__ */ Yoga_Om_Strom.fromArray([ 1, 1, 2, 2, 2, 3, 1, 1, 4 ])));
var example7b = /* #__PURE__ */ Yoga_Om_Strom.traverseStrom_(function (batch) {
    return bind1(ask)(function (v) {
        return Yoga_Om.fromAff(v.logger("Processing batch of " + (show1(Data_Array.length(batch)) + " items")));
    });
})(/* #__PURE__ */ Yoga_Om_Strom.mapStrom(function (x) {
    return [ x ];
})(/* #__PURE__ */ Yoga_Om_Strom.rangeStrom(1)(100)));
var example7 = /* #__PURE__ */ Yoga_Om_Strom.runCollect(/* #__PURE__ */ Yoga_Om_Strom.mapStrom(function (x) {
    return [ x ];
})(/* #__PURE__ */ Yoga_Om_Strom.rangeStrom(1)(11)));
var example6b = /* #__PURE__ */ Yoga_Om_Strom.runCollect(/* #__PURE__ */ Yoga_Om_Strom.takeStrom(5)(/* #__PURE__ */ Yoga_Om_Strom.takeWhileStrom(function (v) {
    return v === 42;
})(/* #__PURE__ */ Yoga_Om_Strom.repeatStrom(42))));
var example6 = /* #__PURE__ */ Yoga_Om_Strom.runCollect(/* #__PURE__ */ Yoga_Om_Strom.takeStrom(10)(/* #__PURE__ */ Yoga_Om_Strom.iterateStrom(function (v) {
    return v + 1 | 0;
})(0)));
var example5c = /* #__PURE__ */ (function () {
    var stream1 = Yoga_Om_Strom.fromArray([ 1, 2, 3 ]);
    var stream2 = Yoga_Om_Strom.fromArray([ 4, 5, 6 ]);
    return Yoga_Om_Strom.runCollect(alt(stream1)(stream2));
})();
var example5b = /* #__PURE__ */ (function () {
    var evens = Yoga_Om_Strom.fromArray([ 2, 4, 6, 8 ]);
    var odds = Yoga_Om_Strom.fromArray([ 1, 3, 5, 7 ]);
    return Yoga_Om_Strom.runCollect(Data_Semigroup.append(Yoga_Om_Strom.semigroupStrom)(odds)(evens));
})();
var example5 = /* #__PURE__ */ (function () {
    var numbers = Yoga_Om_Strom.rangeStrom(1)(5);
    var _letters = Yoga_Om_Strom.fromArray([ "a", "b", "c", "d", "e" ]);
    return Yoga_Om_Strom.runCollect(Yoga_Om_Strom.mapStrom(function (n) {
        return new Data_Tuple.Tuple(n, "stub");
    })(numbers));
})();
var example4b = /* #__PURE__ */ Yoga_Om_Strom.runCollect(/* #__PURE__ */ Yoga_Om_Strom.mapAccumStrom(function (count) {
    return function (item) {
        return new Data_Tuple.Tuple(count + 1 | 0, show1(count) + (": " + item));
    };
})(1)(/* #__PURE__ */ Yoga_Om_Strom.fromArray([ "a", "b", "c", "d" ])));
var example4 = /* #__PURE__ */ Yoga_Om_Strom.runCollect(/* #__PURE__ */ Yoga_Om_Strom.scanStrom(function (acc) {
    return function (n) {
        return acc + n | 0;
    };
})(0)(/* #__PURE__ */ Yoga_Om_Strom.fromArray([ 1, 2, 3, 4, 5 ])));
var example3 = /* #__PURE__ */ Yoga_Om_Strom.runCollect(/* #__PURE__ */ Yoga_Om_Strom.mapMStrom(fetchUser)(/* #__PURE__ */ Yoga_Om_Strom.rangeStrom(1)(20)));
var example2 = /* #__PURE__ */ Yoga_Om_Strom.traverseStrom_(function (n) {
    return bind1(ask)(function (v) {
        return Yoga_Om.fromAff(v.logger("Result: " + show1(n)));
    });
})(/* #__PURE__ */ Yoga_Om_Strom.mapMStrom(function (n) {
    return discard2(delay(100.0))(function () {
        return pure1(n * n | 0);
    });
})(/* #__PURE__ */ Yoga_Om_Strom.tapMStrom(function (n) {
    return bind1(ask)(function (v) {
        return Yoga_Om.fromAff(v.logger("Processing: " + show1(n)));
    });
})(/* #__PURE__ */ Yoga_Om_Strom.rangeStrom(1)(5))));
var example17b = /* #__PURE__ */ (function () {
    var primaryStream = Yoga_Om_Strom.fromOm($$throw({
        networkError: "Primary failed"
    }));
    var fallbackStream = Yoga_Om_Strom.fromArray([ 1, 2, 3 ]);
    return Yoga_Om_Strom.runCollect(alt(primaryStream)(fallbackStream));
})();
var example17 = /* #__PURE__ */ (function () {
    var riskyStream = Yoga_Om_Strom.mapMStrom(function (n) {
        var $96 = n === 3;
        if ($96) {
            return $$throw({
                networkError: "Connection failed!"
            });
        };
        return pure1(n * 2 | 0);
    })(Yoga_Om_Strom.rangeStrom(1)(5));
    return Yoga_Om_Strom.runCollect(riskyStream);
})();
var example16 = /* #__PURE__ */ (function () {
    var departments = [ {
        name: "Engineering",
        employees: [ "Alice", "Bob" ]
    }, {
        name: "Sales",
        employees: [ "Charlie" ]
    }, {
        name: "Marketing",
        employees: [ "Dave", "Eve", "Frank" ]
    } ];
    return Yoga_Om_Strom.runCollect(bind2(Yoga_Om_Strom.fromArray(departments))(function (dept) {
        return Yoga_Om_Strom.fromArray(dept.employees);
    }));
})();
var example15 = /* #__PURE__ */ (function () {
    var eventStream = Yoga_Om_Strom.mapMStrom(function (n) {
        return discard2(delay(500.0))(function () {
            return pure1(n);
        });
    })(Yoga_Om_Strom.iterateStrom(function (v) {
        return v + 1 | 0;
    })(0));
    return Yoga_Om_Strom.traverseStrom_(function (n) {
        return bind1(ask)(function (v) {
            return Yoga_Om.fromAff(v.logger("Received: " + show1(n)));
        });
    })(Yoga_Om_Strom.takeStrom(5)(eventStream));
})();
var example14b = /* #__PURE__ */ Yoga_Om_Strom.runCollect(/* #__PURE__ */ Yoga_Om_Strom.dropWhileStrom(function (v) {
    return v < 5;
})(/* #__PURE__ */ Yoga_Om_Strom.rangeStrom(1)(11)));
var example14 = /* #__PURE__ */ Yoga_Om_Strom.runCollect(/* #__PURE__ */ Yoga_Om_Strom.dropStrom(5)(/* #__PURE__ */ Yoga_Om_Strom.rangeStrom(1)(11)));
var example13b = /* #__PURE__ */ Yoga_Om_Strom.runCollect(/* #__PURE__ */ Yoga_Om_Strom.collectMStrom(function (str) {
    return discard2(delay(10.0))(function () {
        return pure1((function () {
            if (str === "1") {
                return new Data_Maybe.Just(1);
            };
            if (str === "2") {
                return new Data_Maybe.Just(2);
            };
            if (str === "3") {
                return new Data_Maybe.Just(3);
            };
            return Data_Maybe.Nothing.value;
        })());
    });
})(/* #__PURE__ */ Yoga_Om_Strom.fromArray([ "1", "not a number", "2", "3", "invalid" ])));
var example13 = /* #__PURE__ */ Yoga_Om_Strom.runCollect(/* #__PURE__ */ Yoga_Om_Strom.collectStrom(parseNumbers)(/* #__PURE__ */ Yoga_Om_Strom.fromArray([ "one", "invalid", "two", "nope", "three" ])));
var example12 = /* #__PURE__ */ (function () {
    var stream = Yoga_Om_Strom.rangeStrom(1)(11);
    var evens = Yoga_Om_Strom.filterStrom(function (n) {
        return mod(n)(2) === 0;
    })(stream);
    var odds = Yoga_Om_Strom.filterStrom(function (n) {
        return mod(n)(2) !== 0;
    })(stream);
    return bind1(Yoga_Om_Strom.runCollect(evens))(function (evensResult) {
        return bind1(Yoga_Om_Strom.runCollect(odds))(function (oddsResult) {
            return pure1({
                evens: evensResult,
                odds: oddsResult
            });
        });
    });
})();
var example11 = /* #__PURE__ */ (function () {
    var source1 = Yoga_Om_Strom.fromOm(discard2(delay(100.0))(function () {
        return pure1(1);
    }));
    var _source3 = Yoga_Om_Strom.fromOm(discard2(delay(200.0))(function () {
        return pure1(3);
    }));
    var _source2 = Yoga_Om_Strom.fromOm(discard2(delay(50.0))(function () {
        return pure1(2);
    }));
    return Yoga_Om_Strom.runCollect(source1);
})();
var example10b = /* #__PURE__ */ Yoga_Om_Strom.runCollect(/* #__PURE__ */ bind2(/* #__PURE__ */ Yoga_Om_Strom.unfoldOmStrom(function (token) {
    return bind1(fetchPage(token))(function (page) {
        if (page.nextToken instanceof Data_Maybe.Nothing) {
            return pure1(Data_Maybe.Nothing.value);
        };
        if (page.nextToken instanceof Data_Maybe.Just) {
            return pure1(new Data_Maybe.Just(new Data_Tuple.Tuple(page.items, page.nextToken.value0)));
        };
        throw new Error("Failed pattern match at Yoga.Om.Strom.Examples (line 271, column 5 - line 273, column 55): " + [ page.nextToken.constructor.name ]);
    });
})("start"))(Yoga_Om_Strom.fromArray));
var example10 = /* #__PURE__ */ Yoga_Om_Strom.runCollect(/* #__PURE__ */ Yoga_Om_Strom.takeStrom(10)(fibonacciStream));
var example1 = /* #__PURE__ */ Yoga_Om_Strom.runCollect(/* #__PURE__ */ Yoga_Om_Strom.filterStrom(function (v) {
    return v > 5;
})(/* #__PURE__ */ Yoga_Om_Strom.mapStrom(function (v) {
    return v * 2 | 0;
})(/* #__PURE__ */ Yoga_Om_Strom.rangeStrom(1)(10))));
var eventProcessingPipeline = /* #__PURE__ */ (function () {
    var events = [ {
        timestamp: 1000,
        userId: "u1",
        action: "login"
    }, {
        timestamp: 1001,
        userId: "u1",
        action: "view"
    }, {
        timestamp: 1002,
        userId: "u2",
        action: "login"
    }, {
        timestamp: 1003,
        userId: "u1",
        action: "view"
    }, {
        timestamp: 1004,
        userId: "u1",
        action: "view"
    }, {
        timestamp: 1005,
        userId: "u2",
        action: "purchase"
    } ];
    return Yoga_Om_Strom.traverseStrom_(function (batch) {
        return bind1(ask)(function (v) {
            return Yoga_Om.fromAff(v.logger("Processed batch of " + show1(Data_Array.length(batch))));
        });
    })(Yoga_Om_Strom.mapStrom(function (x) {
        return [ x ];
    })(Yoga_Om_Strom.tapMStrom(function (v) {
        return bind1(ask)(function (v1) {
            return Yoga_Om.fromAff(v1.logger("Event #" + (show1(v.seq) + (": " + (v.event.userId + (" - " + v.event.action))))));
        });
    })(Yoga_Om_Strom.mapAccumStrom(function (seq) {
        return function (event) {
            return new Data_Tuple.Tuple(seq + 1 | 0, {
                seq: seq,
                event: event
            });
        };
    })(0)(Yoga_Om_Strom.changesStrom(Data_Eq.eqRec()(Data_Eq.eqRowCons(Data_Eq.eqRowCons(Data_Eq.eqRowCons(Data_Eq.eqRowNil)()({
        reflectSymbol: function () {
            return "userId";
        }
    })(Data_Eq.eqString))()({
        reflectSymbol: function () {
            return "timestamp";
        }
    })(Data_Eq.eqInt))()({
        reflectSymbol: function () {
            return "action";
        }
    })(Data_Eq.eqString)))(Yoga_Om_Strom.filterStrom(function (e) {
        return e.action !== "login";
    })(Yoga_Om_Strom.fromArray(events)))))));
})();
export {
    example1,
    example2,
    fetchUser,
    example3,
    example4,
    example4b,
    example5,
    example5b,
    example5c,
    example6,
    example6b,
    example7,
    example7b,
    example8,
    example9,
    fibonacciStream,
    example10,
    fetchPage,
    example10b,
    example11,
    example12,
    parseNumbers,
    example13,
    example13b,
    example14,
    example14b,
    example15,
    example16,
    NetworkError,
    ValidationError,
    TimeoutError,
    example17,
    example17b,
    eventProcessingPipeline,
    runExample,
    runExampleWithLogger
};
//# sourceMappingURL=index.js.map
