// Generated by purs version 0.15.15
import * as Control_Applicative from "../Control.Applicative/index.js";
import * as Control_Bind from "../Control.Bind/index.js";
import * as Control_Monad_Error_Class from "../Control.Monad.Error.Class/index.js";
import * as Data_Array from "../Data.Array/index.js";
import * as Data_DateTime_Instant from "../Data.DateTime.Instant/index.js";
import * as Data_Eq from "../Data.Eq/index.js";
import * as Data_EuclideanRing from "../Data.EuclideanRing/index.js";
import * as Data_Functor from "../Data.Functor/index.js";
import * as Data_Int from "../Data.Int/index.js";
import * as Data_Maybe from "../Data.Maybe/index.js";
import * as Data_Ord from "../Data.Ord/index.js";
import * as Data_Semigroup from "../Data.Semigroup/index.js";
import * as Data_Semiring from "../Data.Semiring/index.js";
import * as Data_Show from "../Data.Show/index.js";
import * as Data_Time_Duration from "../Data.Time.Duration/index.js";
import * as Data_Traversable from "../Data.Traversable/index.js";
import * as Data_Tuple from "../Data.Tuple/index.js";
import * as Data_Unit from "../Data.Unit/index.js";
import * as Effect_Aff from "../Effect.Aff/index.js";
import * as Effect_Class from "../Effect.Class/index.js";
import * as Effect_Console from "../Effect.Console/index.js";
import * as Effect_Now from "../Effect.Now/index.js";
import * as Yoga_Om from "../Yoga.Om/index.js";
import * as Yoga_Om_Strom from "../Yoga.Om.Strom/index.js";
var runOm1 = /* #__PURE__ */ Yoga_Om.runOm()()();
var throwError = /* #__PURE__ */ Control_Monad_Error_Class.throwError(Effect_Aff.monadThrowAff);
var discard = /* #__PURE__ */ Control_Bind.discard(Control_Bind.discardUnit);
var discard1 = /* #__PURE__ */ discard(Effect_Aff.bindAff);
var liftEffect = /* #__PURE__ */ Effect_Class.liftEffect(Effect_Aff.monadEffectAff);
var show = /* #__PURE__ */ Data_Show.show(Data_Show.showInt);
var bind = /* #__PURE__ */ Control_Bind.bind(Effect_Aff.bindAff);
var sequence = /* #__PURE__ */ Data_Traversable.sequence(Data_Traversable.traversableArray)(Effect_Aff.applicativeAff);
var diff = /* #__PURE__ */ Data_DateTime_Instant.diff(Data_Time_Duration.durationMilliseconds);
var pure = /* #__PURE__ */ Control_Applicative.pure(Effect_Aff.applicativeAff);
var add = /* #__PURE__ */ Data_Semiring.add(Data_Semiring.semiringNumber);
var sort = /* #__PURE__ */ Data_Array.sort(Data_Ord.ordNumber);
var div = /* #__PURE__ */ Data_EuclideanRing.div(Data_EuclideanRing.euclideanRingInt);
var show1 = /* #__PURE__ */ Data_Show.show(Data_Show.showNumber);
var add1 = /* #__PURE__ */ Data_Semiring.add(Data_Semiring.semiringInt);
var mod = /* #__PURE__ */ Data_EuclideanRing.mod(Data_EuclideanRing.euclideanRingInt);
var $$void = /* #__PURE__ */ Data_Functor["void"](Effect_Aff.functorAff);
var discard3 = /* #__PURE__ */ discard(Yoga_Om.bindOm);
var delay = /* #__PURE__ */ Yoga_Om.delay(Yoga_Om.monadAffOm)(Data_Time_Duration.durationMilliseconds);
var pure2 = /* #__PURE__ */ Control_Applicative.pure(Yoga_Om.applicativeOm);
var changesStrom = /* #__PURE__ */ Yoga_Om_Strom.changesStrom(Data_Eq.eqInt);
var append1 = /* #__PURE__ */ Data_Semigroup.append(Data_Semigroup.semigroupArray);
var runOm = function (om) {
    return runOm1({})({
        exception: function (err) {
            return throwError(err);
        }
    })(om);
};
var benchAff = function (name) {
    return function (runs) {
        return function (action) {
            return discard1(liftEffect(Effect_Console.log("\x0a\ud83c\udfc3 " + (name + (" (runs: " + (show(runs) + ")"))))))(function () {
                return bind(sequence(Data_Array.replicate(runs)(bind(liftEffect(Effect_Now.now))(function (start) {
                    return discard1(action)(function () {
                        return bind(liftEffect(Effect_Now.now))(function (end) {
                            var v = diff(end)(start);
                            return pure(v);
                        });
                    });
                }))))(function (times) {
                    var sum = Data_Array.foldl(add)(0.0)(times);
                    var sorted = sort(times);
                    var n = Data_Int.toNumber(runs);
                    var min = Data_Array.head(sorted);
                    var median = Data_Array.index(sorted)(div(runs)(2));
                    var mean = sum / n;
                    var max = Data_Array.last(sorted);
                    return liftEffect(function __do() {
                        (function () {
                            if (min instanceof Data_Maybe.Just) {
                                return Effect_Console.log("  min:    " + (show1(min.value0) + " ms"))();
                            };
                            if (min instanceof Data_Maybe.Nothing) {
                                return Data_Unit.unit;
                            };
                            throw new Error("Failed pattern match at Benchmark.MinibenchMain (line 46, column 5 - line 48, column 27): " + [ min.constructor.name ]);
                        })();
                        (function () {
                            if (median instanceof Data_Maybe.Just) {
                                return Effect_Console.log("  median: " + (show1(median.value0) + " ms"))();
                            };
                            if (median instanceof Data_Maybe.Nothing) {
                                return Data_Unit.unit;
                            };
                            throw new Error("Failed pattern match at Benchmark.MinibenchMain (line 49, column 5 - line 51, column 27): " + [ median.constructor.name ]);
                        })();
                        Effect_Console.log("  mean:   " + (show1(mean) + " ms"))();
                        if (max instanceof Data_Maybe.Just) {
                            return Effect_Console.log("  max:    " + (show1(max.value0) + " ms"))();
                        };
                        if (max instanceof Data_Maybe.Nothing) {
                            return Data_Unit.unit;
                        };
                        throw new Error("Failed pattern match at Benchmark.MinibenchMain (line 53, column 5 - line 55, column 27): " + [ max.constructor.name ]);
                    });
                });
            });
        };
    };
};
var main = /* #__PURE__ */ Effect_Aff.launchAff_(/* #__PURE__ */ discard1(/* #__PURE__ */ liftEffect(/* #__PURE__ */ Effect_Console.log("\ud83d\udd25 Strom Performance Benchmark Suite")))(function () {
    return discard1(liftEffect(Effect_Console.log("=====================================")))(function () {
        return discard1(liftEffect(Effect_Console.log("")))(function () {
            return discard1(benchAff("map-2M")(10)(runOm(Yoga_Om_Strom.runDrain(Yoga_Om_Strom.mapStrom(function (v) {
                return v + 1 | 0;
            })(Yoga_Om_Strom.rangeStrom(1)(2000001))))))(function () {
                return discard1(benchAff("filter-2M-50pct")(10)(runOm(Yoga_Om_Strom.runDrain(Yoga_Om_Strom.filterStrom(function (n) {
                    return mod(n)(2) === 0;
                })(Yoga_Om_Strom.rangeStrom(1)(2000001))))))(function () {
                    return discard1(benchAff("map-chain-3x-2M")(10)(runOm(Yoga_Om_Strom.runDrain(Yoga_Om_Strom.mapStrom(function (v) {
                        return v - 1 | 0;
                    })(Yoga_Om_Strom.mapStrom(function (v) {
                        return v * 2 | 0;
                    })(Yoga_Om_Strom.mapStrom(function (v) {
                        return v + 1 | 0;
                    })(Yoga_Om_Strom.rangeStrom(1)(2000001))))))))(function () {
                        return discard1(benchAff("pipeline-map-filter-map-2M")(10)(runOm(Yoga_Om_Strom.runDrain(Yoga_Om_Strom.mapStrom(function (v) {
                            return v * 2 | 0;
                        })(Yoga_Om_Strom.filterStrom(function (n) {
                            return mod(n)(3) === 0;
                        })(Yoga_Om_Strom.mapStrom(function (v) {
                            return v + 1 | 0;
                        })(Yoga_Om_Strom.rangeStrom(1)(2000001))))))))(function () {
                            return discard1(benchAff("fold-sum-1M")(10)($$void(runOm(Yoga_Om_Strom.runFold(0)(function (acc) {
                                return function (n) {
                                    return acc + n | 0;
                                };
                            })(Yoga_Om_Strom.rangeStrom(1)(1000001))))))(function () {
                                return discard1(benchAff("collect-50k")(10)($$void(runOm(Yoga_Om_Strom.runCollect(Yoga_Om_Strom.rangeStrom(1)(50001))))))(function () {
                                    return discard1(benchAff("take-5k-from-2M")(10)(runOm(Yoga_Om_Strom.runDrain(Yoga_Om_Strom.takeStrom(5000)(Yoga_Om_Strom.rangeStrom(1)(2000001))))))(function () {
                                        return discard1(benchAff("mergeND-2x1M-pure")(10)(runOm(Yoga_Om_Strom.runDrain(Yoga_Om_Strom.mergeND(Yoga_Om_Strom.rangeStrom(1)(1000001))(Yoga_Om_Strom.rangeStrom(1000001)(2000001))))))(function () {
                                            return discard1(benchAff("mergeND-2x100-with-delay")(10)(runOm(Yoga_Om_Strom.runDrain(Yoga_Om_Strom.mergeND(Yoga_Om_Strom.mapMStrom(function (n) {
                                                return discard3(delay(1.0))(function () {
                                                    return pure2(n);
                                                });
                                            })(Yoga_Om_Strom.rangeStrom(1)(101)))(Yoga_Om_Strom.mapMStrom(function (n) {
                                                return discard3(delay(1.0))(function () {
                                                    return pure2(n);
                                                });
                                            })(Yoga_Om_Strom.rangeStrom(101)(201)))))))(function () {
                                                return discard1(benchAff("mapPar-concurrency4-5k-pure")(10)(runOm(Yoga_Om_Strom.runDrain(Yoga_Om_Strom.mapPar(4)(function (n) {
                                                    return pure2(n * 2 | 0);
                                                })(Yoga_Om_Strom.rangeStrom(1)(5001))))))(function () {
                                                    return discard1(benchAff("mapPar-concurrency4-100-with-delay")(10)(runOm(Yoga_Om_Strom.runDrain(Yoga_Om_Strom.mapPar(4)(function (n) {
                                                        return discard3(delay(10.0))(function () {
                                                            return pure2(n * 2 | 0);
                                                        });
                                                    })(Yoga_Om_Strom.rangeStrom(1)(101))))))(function () {
                                                        return discard1(benchAff("scan-running-sum-2M")(10)(runOm(Yoga_Om_Strom.runDrain(Yoga_Om_Strom.scanStrom(function (acc) {
                                                            return function (n) {
                                                                return acc + n | 0;
                                                            };
                                                        })(0)(Yoga_Om_Strom.rangeStrom(1)(2000001))))))(function () {
                                                            return discard1(benchAff("unfold-10k")(10)(runOm(Yoga_Om_Strom.runDrain(Yoga_Om_Strom.unfoldStrom(function (n) {
                                                                var $57 = n > 10000;
                                                                if ($57) {
                                                                    return Data_Maybe.Nothing.value;
                                                                };
                                                                return new Data_Maybe.Just(new Data_Tuple.Tuple(n, n + 1 | 0));
                                                            })(1)))))(function () {
                                                                return discard1(benchAff("infinite-iterate-take-10k")(10)(runOm(Yoga_Om_Strom.runDrain(Yoga_Om_Strom.takeStrom(10000)(Yoga_Om_Strom.iterateStromInfinite(function (v) {
                                                                    return v + 1 | 0;
                                                                })(0))))))(function () {
                                                                    return discard1(benchAff("bind-5kx10")(10)(runOm(Yoga_Om_Strom.runDrain(Yoga_Om_Strom.bindStrom(function (n) {
                                                                        return Yoga_Om_Strom.rangeStrom(n)(n + 10 | 0);
                                                                    })(Yoga_Om_Strom.rangeStrom(1)(5001))))))(function () {
                                                                        return discard1(benchAff("zip-2x500k")(10)(runOm(Yoga_Om_Strom.runDrain(Yoga_Om_Strom.zipStrom(Yoga_Om_Strom.rangeStrom(1)(500001))(Yoga_Om_Strom.rangeStrom(500001)(1000001))))))(function () {
                                                                            return discard1(benchAff("fromArray-1M")(10)(runOm(Yoga_Om_Strom.runDrain(Yoga_Om_Strom.fromArray(Data_Array.range(1)(1000000))))))(function () {
                                                                                return discard1(benchAff("iterateStrom-10k")(10)(runOm(Yoga_Om_Strom.runDrain(Yoga_Om_Strom.iterateStrom(function (v) {
                                                                                    return v + 1 | 0;
                                                                                })(0)))))(function () {
                                                                                    return discard1(benchAff("repeatStrom-10k")(10)(runOm(Yoga_Om_Strom.runDrain(Yoga_Om_Strom.repeatStrom(42)))))(function () {
                                                                                        return discard1(benchAff("mapM-effect-50k")(10)(runOm(Yoga_Om_Strom.runDrain(Yoga_Om_Strom.mapMStrom(function (n) {
                                                                                            return pure2(n * 2 | 0);
                                                                                        })(Yoga_Om_Strom.rangeStrom(1)(50001))))))(function () {
                                                                                            return discard1(benchAff("tap-50k")(10)(runOm(Yoga_Om_Strom.runDrain(Yoga_Om_Strom.tapStrom(function (v) {
                                                                                                return Data_Unit.unit;
                                                                                            })(Yoga_Om_Strom.rangeStrom(1)(50001))))))(function () {
                                                                                                return discard1(benchAff("collect-filter-map-50k")(10)(runOm(Yoga_Om_Strom.runDrain(Yoga_Om_Strom.collectStrom(function (n) {
                                                                                                    var $58 = mod(n)(2) === 0;
                                                                                                    if ($58) {
                                                                                                        return new Data_Maybe.Just(n * 2 | 0);
                                                                                                    };
                                                                                                    return Data_Maybe.Nothing.value;
                                                                                                })(Yoga_Om_Strom.rangeStrom(1)(50001))))))(function () {
                                                                                                    return discard1(benchAff("changes-50k")(10)(runOm(Yoga_Om_Strom.runDrain(changesStrom(Yoga_Om_Strom.fromArray(append1(Data_Array.replicate(50000)(1))([ 2 ])))))))(function () {
                                                                                                        return discard1(benchAff("takeWhile-50k")(10)(runOm(Yoga_Om_Strom.runDrain(Yoga_Om_Strom.takeWhileStrom(function (v) {
                                                                                                            return v < 50000;
                                                                                                        })(Yoga_Om_Strom.rangeStrom(1)(1000001))))))(function () {
                                                                                                            return discard1(benchAff("drop-5k-from-1M")(10)(runOm(Yoga_Om_Strom.runDrain(Yoga_Om_Strom.dropStrom(5000)(Yoga_Om_Strom.rangeStrom(1)(1000001))))))(function () {
                                                                                                                return discard1(benchAff("dropWhile-half-1M")(10)(runOm(Yoga_Om_Strom.runDrain(Yoga_Om_Strom.dropWhileStrom(function (v) {
                                                                                                                    return v < 500000;
                                                                                                                })(Yoga_Om_Strom.rangeStrom(1)(1000001))))))(function () {
                                                                                                                    return discard1(benchAff("grouped-chunks-of-100-from-50k")(10)(runOm(Yoga_Om_Strom.runDrain(Yoga_Om_Strom.groupedStrom(100)(Yoga_Om_Strom.rangeStrom(1)(50001))))))(function () {
                                                                                                                        return discard1(benchAff("partition-even-odd-50k")(10)(runOm((function () {
                                                                                                                            var v = Yoga_Om_Strom.partition(function (n) {
                                                                                                                                return mod(n)(2) === 0;
                                                                                                                            })(Yoga_Om_Strom.rangeStrom(1)(50001));
                                                                                                                            return Yoga_Om_Strom.runDrain(Yoga_Om_Strom.appendStrom(v.value0)(v.value1));
                                                                                                                        })())))(function () {
                                                                                                                            return discard1(benchAff("append-2x500k")(10)(runOm(Yoga_Om_Strom.runDrain(Yoga_Om_Strom.appendStrom(Yoga_Om_Strom.rangeStrom(1)(500001))(Yoga_Om_Strom.rangeStrom(500001)(1000001))))))(function () {
                                                                                                                                return discard1(benchAff("concat-10x10k")(10)(runOm(Yoga_Om_Strom.runDrain(Yoga_Om_Strom.concatStrom(Data_Array.replicate(10)(Yoga_Om_Strom.rangeStrom(1)(10001)))))))(function () {
                                                                                                                                    return discard1(benchAff("zipWith-add-2x500k")(10)(runOm(Yoga_Om_Strom.runDrain(Yoga_Om_Strom.zipWithStrom(add1)(Yoga_Om_Strom.rangeStrom(1)(500001))(Yoga_Om_Strom.rangeStrom(1)(500001))))))(function () {
                                                                                                                                        return discard1(benchAff("interleave-2x50k")(10)(runOm(Yoga_Om_Strom.runDrain(Yoga_Om_Strom.interleave(Yoga_Om_Strom.rangeStrom(1)(50001))(Yoga_Om_Strom.rangeStrom(50001)(100001))))))(function () {
                                                                                                                                            return discard1(benchAff("merge-2x500k")(10)(runOm(Yoga_Om_Strom.runDrain(Yoga_Om_Strom.merge(Yoga_Om_Strom.rangeStrom(1)(500001))(Yoga_Om_Strom.rangeStrom(500001)(1000001))))))(function () {
                                                                                                                                                return discard1(benchAff("mergeAll-10x10k")(10)(runOm(Yoga_Om_Strom.runDrain(Yoga_Om_Strom.mergeAll(Data_Array.replicate(10)(Yoga_Om_Strom.rangeStrom(1)(10001)))))))(function () {
                                                                                                                                                    return discard1(benchAff("race-2x50k")(10)(runOm(Yoga_Om_Strom.runDrain(Yoga_Om_Strom.race(Yoga_Om_Strom.rangeStrom(1)(50001))(Yoga_Om_Strom.rangeStrom(50001)(100001))))))(function () {
                                                                                                                                                        return discard1(benchAff("foreachPar-concurrency8-1k")(10)(runOm(Yoga_Om_Strom.foreachPar(8)(function (v) {
                                                                                                                                                            return pure2(Data_Unit.unit);
                                                                                                                                                        })(Yoga_Om_Strom.rangeStrom(1)(1001)))))(function () {
                                                                                                                                                            return discard1(benchAff("mapMPar-concurrency8-1k")(10)(runOm(Yoga_Om_Strom.runDrain(Yoga_Om_Strom.mapMPar(8)(function (n) {
                                                                                                                                                                return pure2(n * 2 | 0);
                                                                                                                                                            })(Yoga_Om_Strom.rangeStrom(1)(1001))))))(function () {
                                                                                                                                                                return discard1(benchAff("catchAll-no-errors-50k")(10)(runOm(Yoga_Om_Strom.runDrain(Yoga_Om_Strom.catchAll(function (v) {
                                                                                                                                                                    return Yoga_Om_Strom.succeed(0);
                                                                                                                                                                })(Yoga_Om_Strom.rangeStrom(1)(50001))))))(function () {
                                                                                                                                                                    return liftEffect(Effect_Console.log("\x0a\u2728 Benchmark suite complete!"));
                                                                                                                                                                });
                                                                                                                                                            });
                                                                                                                                                        });
                                                                                                                                                    });
                                                                                                                                                });
                                                                                                                                            });
                                                                                                                                        });
                                                                                                                                    });
                                                                                                                                });
                                                                                                                            });
                                                                                                                        });
                                                                                                                    });
                                                                                                                });
                                                                                                            });
                                                                                                        });
                                                                                                    });
                                                                                                });
                                                                                            });
                                                                                        });
                                                                                    });
                                                                                });
                                                                            });
                                                                        });
                                                                    });
                                                                });
                                                            });
                                                        });
                                                    });
                                                });
                                            });
                                        });
                                    });
                                });
                            });
                        });
                    });
                });
            });
        });
    });
}));
export {
    runOm,
    benchAff,
    main
};
//# sourceMappingURL=index.js.map
