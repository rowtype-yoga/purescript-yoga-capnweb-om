// Generated by purs version 0.15.15
import * as Control_Alt from "../Control.Alt/index.js";
import * as Control_Applicative from "../Control.Applicative/index.js";
import * as Control_Bind from "../Control.Bind/index.js";
import * as Control_Monad_Error_Class from "../Control.Monad.Error.Class/index.js";
import * as Control_Monad_Reader_Class from "../Control.Monad.Reader.Class/index.js";
import * as Control_Monad_Reader_Trans from "../Control.Monad.Reader.Trans/index.js";
import * as Control_Monad_Trans_Class from "../Control.Monad.Trans.Class/index.js";
import * as Control_Parallel from "../Control.Parallel/index.js";
import * as Control_Parallel_Class from "../Control.Parallel.Class/index.js";
import * as Control_Plus from "../Control.Plus/index.js";
import * as Data_Either from "../Data.Either/index.js";
import * as Data_Foldable from "../Data.Foldable/index.js";
import * as Data_Functor from "../Data.Functor/index.js";
import * as Data_Maybe from "../Data.Maybe/index.js";
import * as Data_Monoid from "../Data.Monoid/index.js";
import * as Data_Time_Duration from "../Data.Time.Duration/index.js";
import * as Data_Traversable from "../Data.Traversable/index.js";
import * as Data_Tuple from "../Data.Tuple/index.js";
import * as Data_Unit from "../Data.Unit/index.js";
import * as Data_Variant from "../Data.Variant/index.js";
import * as Effect from "../Effect/index.js";
import * as Effect_Aff from "../Effect.Aff/index.js";
import * as Effect_Aff_AVar from "../Effect.Aff.AVar/index.js";
import * as Effect_Aff_Class from "../Effect.Aff.Class/index.js";
import * as Effect_Class from "../Effect.Class/index.js";
import * as Effect_Exception from "../Effect.Exception/index.js";
import * as Record from "../Record/index.js";
import * as Record_Studio_Shrink from "../Record.Studio.Shrink/index.js";
import * as Type_Proxy from "../Type.Proxy/index.js";
import * as Uncurried_RWSET from "../Uncurried.RWSET/index.js";
import * as Unsafe_Coerce from "../Unsafe.Coerce/index.js";
import * as Yoga_Om_Error from "../Yoga.Om.Error/index.js";
var semigroupRWSET = /* #__PURE__ */ Uncurried_RWSET.semigroupRWSET(Data_Monoid.monoidUnit);
var disjointUnion = /* #__PURE__ */ Record.disjointUnion()();
var bind = /* #__PURE__ */ Control_Bind.bind(Effect_Aff.bindAff);
var runRWSET = /* #__PURE__ */ Uncurried_RWSET.runRWSET(Effect_Aff.monadRecAff);
var pure = /* #__PURE__ */ Control_Applicative.pure(Effect_Aff.applicativeAff);
var match = /* #__PURE__ */ Data_Variant.match()()();
var map = /* #__PURE__ */ Data_Functor.map(Effect_Aff.functorAff);
var sequential = /* #__PURE__ */ Control_Parallel_Class.sequential(Effect_Aff.parallelAff);
var throwError = /* #__PURE__ */ Control_Monad_Error_Class.throwError(Effect_Aff.monadThrowAff);
var alt = /* #__PURE__ */ Control_Alt.alt(Effect_Aff.altParAff);
var parallel = /* #__PURE__ */ Control_Parallel_Class.parallel(Effect_Aff.parallelAff);
var discard = /* #__PURE__ */ Control_Bind.discard(Control_Bind.discardUnit)(Effect_Aff.bindAff);
var $$void = /* #__PURE__ */ Data_Functor["void"](Effect_Aff.functorAff);
var pure1 = /* #__PURE__ */ Control_Applicative.pure(Effect_Aff.applicativeParAff);
var $$try = /* #__PURE__ */ Control_Monad_Error_Class["try"](Effect_Aff.monadErrorAff);
var mapFlipped = /* #__PURE__ */ Data_Functor.mapFlipped(Effect_Aff.functorAff);
var void1 = /* #__PURE__ */ Data_Functor["void"](Effect.functorEffect);
var shrink = /* #__PURE__ */ Record_Studio_Shrink.shrink();
var lift = /* #__PURE__ */ Control_Monad_Trans_Class.lift(/* #__PURE__ */ Uncurried_RWSET.monadTransRWSET(Data_Monoid.monoidUnit))(Effect_Aff.monadAff);
var exceptionIsSymbol = {
    reflectSymbol: function () {
        return "exception";
    }
};
var singletonVariantRecord = /* #__PURE__ */ Yoga_Om_Error.singletonVariantRecord()()()(exceptionIsSymbol);
var on = /* #__PURE__ */ Data_Variant.on();
var inj = /* #__PURE__ */ Data_Variant.inj();
var on1 = /* #__PURE__ */ on(exceptionIsSymbol);
var onMatch = /* #__PURE__ */ Data_Variant.onMatch()()();
var ParOm = function (x) {
    return x;
};
var Om = function (x) {
    return x;
};
var semigroupOm = function (dictSemigroup) {
    return semigroupRWSET(dictSemigroup);
};
var newtypeOm_ = {
    Coercible0: function () {
        return undefined;
    }
};
var monadThrowVariantExceptio = /* #__PURE__ */ Uncurried_RWSET.monadThrowRWSET(Data_Monoid.monoidUnit);
var throwError1 = /* #__PURE__ */ Control_Monad_Error_Class.throwError(monadThrowVariantExceptio);
var monadRecOm = /* #__PURE__ */ Uncurried_RWSET.monadRecRWSET(Data_Monoid.monoidUnit);
var monadReaderOm = /* #__PURE__ */ Uncurried_RWSET.monadReaderRWSET(Data_Monoid.monoidUnit);
var monadOm = /* #__PURE__ */ Uncurried_RWSET.monadRWSET(Data_Monoid.monoidUnit);
var monadErrorVariantExceptio = /* #__PURE__ */ Uncurried_RWSET.monadErrorRWSET(Data_Monoid.monoidUnit);
var monadAskOm = /* #__PURE__ */ Uncurried_RWSET.monadAskRWSET(Data_Monoid.monoidUnit);
var ask = /* #__PURE__ */ Control_Monad_Reader_Class.ask(monadAskOm);
var functorParOm = Uncurried_RWSET.functorRWSET;
var functorOm = Uncurried_RWSET.functorRWSET;
var voidLeft = /* #__PURE__ */ Data_Functor.voidLeft(functorOm);
var map1 = /* #__PURE__ */ Data_Functor.map(functorOm);
var bindOm = /* #__PURE__ */ Uncurried_RWSET.bindRWSET(Data_Monoid.monoidUnit);
var bind1 = /* #__PURE__ */ Control_Bind.bind(bindOm);
var applyOm = /* #__PURE__ */ Uncurried_RWSET.applyRWSET(Data_Monoid.monoidUnit);
var applicativeOm = /* #__PURE__ */ Uncurried_RWSET.applicativeRWSET(Data_Monoid.monoidUnit);
var pure2 = /* #__PURE__ */ Control_Applicative.pure(applicativeOm);
var altOm = /* #__PURE__ */ Uncurried_RWSET.altRWSET(Data_Monoid.monoidUnit);
var widenCtx = function () {
    return function () {
        return function (toUnion) {
            return function (v) {
                return Uncurried_RWSET.withRWSET(function (r) {
                    return function (v1) {
                        return new Data_Tuple.Tuple(disjointUnion(toUnion)(r), Data_Unit.unit);
                    };
                })(v);
            };
        };
    };
};
var toOm = function (dict) {
    return dict.toOm;
};
var throwLeftAsM = function (dictMonadThrow) {
    var Monad0 = dictMonadThrow.Monad0();
    var composeKleisliFlipped = Control_Bind.composeKleisliFlipped(Monad0.Bind1());
    var throwError2 = Control_Monad_Error_Class.throwError(dictMonadThrow);
    var pure3 = Control_Applicative.pure(Monad0.Applicative0());
    return function (toError) {
        return Data_Either.either(composeKleisliFlipped(throwError2)(toError))(pure3);
    };
};
var throwLeftAs = function (dictMonadThrow) {
    var throwError2 = Control_Monad_Error_Class.throwError(dictMonadThrow);
    var pure3 = Control_Applicative.pure((dictMonadThrow.Monad0()).Applicative0());
    return function (toError) {
        return Data_Either.either(function ($237) {
            return throwError2(toError($237));
        })(pure3);
    };
};
var tapM = function (f) {
    return function (ma) {
        return bind1(ma)(function (a) {
            return voidLeft(f(a))(a);
        });
    };
};
var tap = function (f) {
    return function (a) {
        return voidLeft(f(a))(a);
    };
};
var runOm = function () {
    return function () {
        return function () {
            return function (ctx) {
                return function (errorHandlers) {
                    return function (v) {
                        return bind(runRWSET(ctx)(Data_Unit.unit)(v))(function (v1) {
                            if (v1.value1.value0 instanceof Data_Either.Right) {
                                return pure(v1.value1.value0.value0);
                            };
                            if (v1.value1.value0 instanceof Data_Either.Left) {
                                return match(errorHandlers)(v1.value1.value0.value0);
                            };
                            throw new Error("Failed pattern match at Yoga.Om (line 380, column 29 - line 382, column 53): " + [ v1.constructor.name ]);
                        });
                    };
                };
            };
        };
    };
};
var runOm1 = /* #__PURE__ */ runOm()()();
var readerT = function (dictFunctor) {
    var rwseT = Uncurried_RWSET.rwseT(dictFunctor)(Data_Monoid.monoidUnit);
    var mapFlipped1 = Data_Functor.mapFlipped(dictFunctor);
    return function (k) {
        return rwseT(function (r) {
            return function (v) {
                return mapFlipped1(k(r))(function (x) {
                    return new Data_Tuple.Tuple(Data_Unit.unit, new Data_Tuple.Tuple(x, Data_Unit.unit));
                });
            };
        });
    };
};
var readerT1 = /* #__PURE__ */ readerT(Effect_Aff.functorParAff);
var readerT2 = /* #__PURE__ */ readerT(Effect_Aff.functorAff);
var parOmToAff = function (ctx) {
    return function (v) {
        return map(function (v1) {
            return v1.value1.value0;
        })(runRWSET(ctx)(Data_Unit.unit)(Uncurried_RWSET.hoistRWSET(sequential)(v)));
    };
};
var altParOm = {
    alt: function (x) {
        return function (y) {
            var throwOut = function (e) {
                return throwError(Yoga_Om_Error.parallelErrorToError(Yoga_Om_Error.newParallelError(e)));
            };
            return readerT1(function (ctx) {
                return alt(parallel(bind(parOmToAff(ctx)(x))(function (res) {
                    return Data_Either.either(throwOut)(function ($238) {
                        return pure(Data_Either.Right.create($238));
                    })(res);
                })))(parallel(bind(parOmToAff(ctx)(y))(function (res) {
                    return Data_Either.either(throwOut)(function ($239) {
                        return pure(Data_Either.Right.create($239));
                    })(res);
                })));
            });
        };
    },
    Functor0: function () {
        return functorParOm;
    }
};
var applyParOm = {
    apply: function (f) {
        return function (a) {
            var runOrKillBoth = function (ctx) {
                return function (resultVar) {
                    return function (otherVar) {
                        return function (comp) {
                            return bind(parOmToAff(ctx)(comp))(function (res) {
                                if (res instanceof Data_Either.Right) {
                                    return Effect_Aff_AVar.put(res.value0)(resultVar);
                                };
                                if (res instanceof Data_Either.Left) {
                                    return (function (err) {
                                        return discard(Effect_Aff_AVar.kill(err)(otherVar))(function () {
                                            return Effect_Aff_AVar.kill(err)(resultVar);
                                        });
                                    })(Yoga_Om_Error.parallelErrorToError(Yoga_Om_Error.newParallelError(res.value0)));
                                };
                                throw new Error("Failed pattern match at Yoga.Om (line 435, column 7 - line 440, column 38): " + [ res.constructor.name ]);
                            });
                        };
                    };
                };
            };
            return readerT1(function (ctx) {
                return parallel(Effect_Aff.supervise(bind(Effect_Aff_AVar.empty)(function (functionVar) {
                    return bind(Effect_Aff_AVar.empty)(function (valueVar) {
                        return discard($$void(Effect_Aff.forkAff(runOrKillBoth(ctx)(functionVar)(valueVar)(f))))(function () {
                            return discard($$void(Effect_Aff.forkAff(runOrKillBoth(ctx)(valueVar)(functionVar)(a))))(function () {
                                return bind(Effect_Aff_AVar.take(functionVar))(function ($$function) {
                                    return bind(Effect_Aff_AVar.take(valueVar))(function (value) {
                                        return pure(new Data_Either.Right($$function(value)));
                                    });
                                });
                            });
                        });
                    });
                })));
            });
        };
    },
    Functor0: function () {
        return functorParOm;
    }
};
var applicativeParOm = {
    pure: function (v) {
        return readerT1(function (v1) {
            return pure1(new Data_Either.Right(v));
        });
    },
    Apply0: function () {
        return applyParOm;
    }
};
var parallelParOmOm = {
    sequential: function (par) {
        return readerT2(function (ctx) {
            return bind(Effect_Aff_AVar.empty)(function (resultVar) {
                return discard($$void(Effect_Aff.forkAff(bind($$try(parOmToAff(ctx)(par)))(function (res) {
                    if (res instanceof Data_Either.Right) {
                        return Effect_Aff_AVar.put(res.value0)(resultVar);
                    };
                    var v = function (v1) {
                        if (res instanceof Data_Either.Left) {
                            return throwError(res.value0);
                        };
                        throw new Error("Failed pattern match at Yoga.Om (line 465, column 1 - line 487, column 59): " + [ res.constructor.name ]);
                    };
                    if (res instanceof Data_Either.Left) {
                        var $209 = Yoga_Om_Error.toParallelError(res.value0);
                        if ($209 instanceof Data_Maybe.Just) {
                            return Effect_Aff_AVar.put(new Data_Either.Left(Yoga_Om_Error.getParallelError($209.value0)))(resultVar);
                        };
                        return v(true);
                    };
                    return v(true);
                }))))(function () {
                    return Effect_Aff_AVar.take(resultVar);
                });
            });
        });
    },
    parallel: function (v) {
        return readerT1(function (ctx) {
            return parallel(mapFlipped(runRWSET(ctx)(Data_Unit.unit)(v))(function (v1) {
                return v1.value1.value0;
            }));
        });
    },
    Apply0: function () {
        return applyOm;
    },
    Apply1: function () {
        return applyParOm;
    }
};
var noteM = function (dictMonadThrow) {
    var Monad0 = dictMonadThrow.Monad0();
    var bindFlipped = Control_Bind.bindFlipped(Monad0.Bind1());
    var throwError2 = Control_Monad_Error_Class.throwError(dictMonadThrow);
    var pure3 = Control_Applicative.pure(Monad0.Applicative0());
    return function (err) {
        return Data_Maybe.maybe(bindFlipped(throwError2)(err))(pure3);
    };
};
var launchOm = function () {
    return function () {
        return function () {
            return function (ctx) {
                return function (handlers) {
                    return function (om) {
                        return Effect_Aff.launchAff(runOm1(ctx)(handlers)(om));
                    };
                };
            };
        };
    };
};
var launchOm1 = /* #__PURE__ */ launchOm()()();
var launchOm_ = function () {
    return function () {
        return function () {
            return function (ctx) {
                return function (handlers) {
                    return function (om) {
                        return void1(launchOm1(ctx)(handlers)(om));
                    };
                };
            };
        };
    };
};
var inParallel = /* #__PURE__ */ Control_Parallel.parSequence(parallelParOmOm)(applicativeParOm)(Data_Traversable.traversableArray);
var expandErr = function () {
    return Unsafe_Coerce.unsafeCoerce;
};
var expandErr1 = /* #__PURE__ */ expandErr();
var expandCtx = function () {
    return function (dictKeys) {
        var shrink1 = shrink(dictKeys);
        return function (v) {
            return Uncurried_RWSET.withRWSET(function (r) {
                return function (s) {
                    return new Data_Tuple.Tuple(shrink1(r), s);
                };
            })(v);
        };
    };
};
var expandCtx1 = /* #__PURE__ */ expandCtx();
var expand = function () {
    return function () {
        return function (dictKeys) {
            var $240 = expandCtx1(dictKeys);
            return function ($241) {
                return expandErr1($240($241));
            };
        };
    };
};
var error = function (dictSingletonVariantRecord) {
    return Yoga_Om_Error.singletonRecordToVariant(dictSingletonVariantRecord);
};
var error1 = /* #__PURE__ */ error(singletonVariantRecord);
var $$throw = function (dictSingletonVariantRecord) {
    var error2 = error(dictSingletonVariantRecord);
    return function (dictMonadThrow) {
        var $242 = Control_Monad_Error_Class.throwError(dictMonadThrow);
        return function ($243) {
            return $242(error2($243));
        };
    };
};
var throw1 = /* #__PURE__ */ $$throw(singletonVariantRecord)(monadThrowVariantExceptio);
var fromAff = function (e) {
    return bind1(lift($$try(e)))(Data_Either.either(function ($244) {
        return throw1((function (v) {
            return {
                exception: v
            };
        })($244));
    })(pure2));
};
var handleErrors$prime = function (handle) {
    return function (v) {
        return bind1(ask)(function (ctx) {
            return bind1(fromAff(mapFlipped(runRWSET(ctx)(Data_Unit.unit)(v))(function (v1) {
                return v1.value1.value0;
            })))(function (result) {
                if (result instanceof Data_Either.Left) {
                    return handle(result.value0);
                };
                if (result instanceof Data_Either.Right) {
                    return pure2(result.value0);
                };
                throw new Error("Failed pattern match at Yoga.Om (line 211, column 3 - line 213, column 21): " + [ result.constructor.name ]);
            });
        });
    };
};
var mapError = function (dictIsSymbol) {
    var on2 = on(dictIsSymbol);
    return function (dictIsSymbol1) {
        var inj1 = inj(dictIsSymbol1);
        return function () {
            return function () {
                return function (f) {
                    return handleErrors$prime(function (variant) {
                        return on2(Type_Proxy["Proxy"].value)((function () {
                            var $245 = inj1(Type_Proxy["Proxy"].value);
                            return function ($246) {
                                return throwError1($245(f($246)));
                            };
                        })())(function ($247) {
                            return throwError1($247);
                        })(variant);
                    });
                };
            };
        };
    };
};
var onError = function (dictIsSymbol) {
    var on2 = on(dictIsSymbol);
    return function () {
        return function (handler) {
            return handleErrors$prime(function (variant) {
                return on2(Type_Proxy["Proxy"].value)(handler)(throwError1)(variant);
            });
        };
    };
};
var runReader = function (ctx) {
    return function (om) {
        return runOm1(ctx)({
            exception: function (exception) {
                return pure(new Data_Either.Left(error1({
                    exception: exception
                })));
            }
        })(handleErrors$prime(function ($248) {
            return pure2(Data_Either.Left.create($248));
        })(map1(Data_Either.Right.create)(om)));
    };
};
var unliftAff = function (om) {
    return map1(function (v) {
        return runReader(v)(om);
    })(ask);
};
var unliftAffFn = function (om) {
    return bind1(ask)(function (ctx) {
        return pure2(function (arg) {
            return bind(runReader(ctx)(om(arg)))(Data_Either.either(on1(Yoga_Om_Error.exception)(function (e) {
                return throwError(e);
            })(Data_Variant.case_))(pure));
        });
    });
};
var monadEffectOm = {
    liftEffect: /* #__PURE__ */ (function () {
        var $249 = Effect_Class.liftEffect(Effect_Aff.monadEffectAff);
        return function ($250) {
            return fromAff($249($250));
        };
    })(),
    Monad0: function () {
        return monadOm;
    }
};
var monadAffOm = {
    liftAff: fromAff,
    MonadEffect0: function () {
        return monadEffectOm;
    }
};
var liftAff = /* #__PURE__ */ Effect_Aff_Class.liftAff(monadAffOm);
var handleErrors = function () {
    return function () {
        return function () {
            return function (cases) {
                return function (v) {
                    return bind1(ask)(function (ctx) {
                        return bind1(liftAff(map(function (v1) {
                            return v1.value1.value0;
                        })(runRWSET(ctx)(Data_Unit.unit)(v))))(function (err) {
                            return Data_Either.either(onMatch(cases)(throwError1))(pure2)(err);
                        });
                    });
                };
            };
        };
    };
};
var toOmAff = {
    toOm: liftAff
};
var toOmEffect = {
    toOm: /* #__PURE__ */ Effect_Class.liftEffect(monadEffectOm)
};
var plusOm = {
    empty: /* #__PURE__ */ fromAff(/* #__PURE__ */ throwError(/* #__PURE__ */ Effect_Exception.error("Always fails"))),
    Alt0: function () {
        return altOm;
    }
};
var plusParOm = {
    empty: /* #__PURE__ */ Control_Parallel_Class.parallel(parallelParOmOm)(/* #__PURE__ */ Control_Plus.empty(plusOm)),
    Alt0: function () {
        return altParOm;
    }
};
var alternativeParOm = {
    Applicative0: function () {
        return applicativeParOm;
    },
    Plus1: function () {
        return plusParOm;
    }
};
var race = /* #__PURE__ */ Control_Parallel.parOneOf(parallelParOmOm)(alternativeParOm)(Data_Foldable.foldableArray)(Data_Functor.functorArray);
var note = function (dictSingletonVariantRecord) {
    var throw2 = $$throw(dictSingletonVariantRecord);
    return function (dictMonadThrow) {
        var throw3 = throw2(dictMonadThrow);
        var pure3 = Control_Applicative.pure((dictMonadThrow.Monad0()).Applicative0());
        return function (err) {
            return Data_Maybe.maybe(throw3(err))(pure3);
        };
    };
};
var delay = function (dictMonadAff) {
    var liftAff1 = Effect_Aff_Class.liftAff(dictMonadAff);
    return function (dictDuration) {
        var $251 = Data_Time_Duration.fromDuration(dictDuration);
        return function ($252) {
            return liftAff1(Effect_Aff.delay($251($252)));
        };
    };
};
export {
    Om,
    ParOm,
    delay,
    error,
    expand,
    expandCtx,
    expandErr,
    fromAff,
    handleErrors,
    mapError,
    onError,
    handleErrors$prime,
    launchOm,
    launchOm_,
    note,
    noteM,
    parOmToAff,
    race,
    inParallel,
    readerT,
    runOm,
    runReader,
    tap,
    tapM,
    $$throw as throw,
    throwLeftAs,
    throwLeftAsM,
    toOm,
    unliftAff,
    unliftAffFn,
    widenCtx,
    newtypeOm_,
    functorOm,
    applicativeOm,
    applyOm,
    bindOm,
    monadOm,
    monadEffectOm,
    monadAffOm,
    monadAskOm,
    monadReaderOm,
    monadThrowVariantExceptio,
    monadErrorVariantExceptio,
    monadRecOm,
    semigroupOm,
    altOm,
    plusOm,
    toOmEffect,
    toOmAff,
    functorParOm,
    applyParOm,
    applicativeParOm,
    parallelParOmOm,
    altParOm,
    plusParOm,
    alternativeParOm
};
export {
    ask,
    asks
} from "../Control.Monad.Reader.Trans/index.js";
//# sourceMappingURL=index.js.map
