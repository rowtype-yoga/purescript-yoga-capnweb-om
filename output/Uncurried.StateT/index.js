// Generated by purs version 0.15.15
import * as Control_Category from "../Control.Category/index.js";
import * as Control_Monad_Error_Class from "../Control.Monad.Error.Class/index.js";
import * as Control_Monad_Reader_Class from "../Control.Monad.Reader.Class/index.js";
import * as Control_Monad_Trans_Class from "../Control.Monad.Trans.Class/index.js";
import * as Control_Monad_Writer_Class from "../Control.Monad.Writer.Class/index.js";
import * as Data_Either from "../Data.Either/index.js";
import * as Data_Functor from "../Data.Functor/index.js";
import * as Data_Monoid from "../Data.Monoid/index.js";
import * as Data_Tuple from "../Data.Tuple/index.js";
import * as Data_Unit from "../Data.Unit/index.js";
import * as Data_Void from "../Data.Void/index.js";
import * as Uncurried_RWSET from "../Uncurried.RWSET/index.js";
var semigroupRWSET = /* #__PURE__ */ Uncurried_RWSET.semigroupRWSET(Data_Monoid.monoidUnit);
var monoidRWSET = /* #__PURE__ */ Uncurried_RWSET.monoidRWSET(Data_Monoid.monoidUnit);
var identity = /* #__PURE__ */ Control_Category.identity(Control_Category.categoryFn);
var monadEffectRWSET = /* #__PURE__ */ Uncurried_RWSET.monadEffectRWSET(Data_Monoid.monoidUnit);
var StateT = function (x) {
    return x;
};
var semigroupStateT = function (dictSemigroup) {
    return semigroupRWSET(dictSemigroup);
};
var monoidStateT = function (dictMonoid) {
    return monoidRWSET(dictMonoid);
};
var monadTransStateT = /* #__PURE__ */ Uncurried_RWSET.monadTransRWSET(Data_Monoid.monoidUnit);
var lift = /* #__PURE__ */ Control_Monad_Trans_Class.lift(monadTransStateT);
var monadStateT = /* #__PURE__ */ Uncurried_RWSET.monadRWSET(Data_Monoid.monoidUnit);
var monadTellStateT = function (dictMonoid) {
    return function (dictMonadTell) {
        var Semigroup0 = dictMonadTell.Semigroup0();
        return {
            tell: (function () {
                var $212 = lift(dictMonadTell.Monad1());
                var $213 = Control_Monad_Writer_Class.tell(dictMonadTell);
                return function ($214) {
                    return $212($213($214));
                };
            })(),
            Semigroup0: function () {
                return Semigroup0;
            },
            Monad1: function () {
                return monadStateT;
            }
        };
    };
};
var monadWriterStateT = function (dictMonoid) {
    return function (dictMonadRec) {
        var mapFlipped = Data_Functor.mapFlipped((((dictMonadRec.Monad0()).Bind1()).Apply0()).Functor0());
        var runRWSET = Uncurried_RWSET.runRWSET(dictMonadRec);
        return function (dictMonadWriter) {
            var listen = Control_Monad_Writer_Class.listen(dictMonadWriter);
            var pass = Control_Monad_Writer_Class.pass(dictMonadWriter);
            var Monoid0 = dictMonadWriter.Monoid0();
            var monadTellStateT1 = monadTellStateT(Monoid0)(dictMonadWriter.MonadTell1());
            return {
                listen: function (v) {
                    return function (environment, state, v1, lift$prime, error, done) {
                        return lift$prime(mapFlipped(listen(runRWSET(environment)(state)(v)))(function (v2) {
                            return function (v3) {
                                if (v2.value0.value1.value0 instanceof Data_Either.Left) {
                                    return error(v2.value0.value0, v2.value0.value1.value0.value0, Data_Unit.unit);
                                };
                                if (v2.value0.value1.value0 instanceof Data_Either.Right) {
                                    return done(v2.value0.value0, new Data_Tuple.Tuple(v2.value0.value1.value0.value0, v2.value1), Data_Unit.unit);
                                };
                                throw new Error("Failed pattern match at Uncurried.StateT (line 125, column 15 - line 129, column 46): " + [ v2.value0.value1.value0.constructor.name ]);
                            };
                        }));
                    };
                },
                pass: function (v) {
                    return function (environment, state, v1, lift$prime, error, done) {
                        return lift$prime(pass(mapFlipped(runRWSET(environment)(state)(v))(function (v2) {
                            if (v2.value1.value0 instanceof Data_Either.Left) {
                                return new Data_Tuple.Tuple(function (v3) {
                                    return error(v2.value0, v2.value1.value0.value0, v2.value1.value1);
                                }, identity);
                            };
                            if (v2.value1.value0 instanceof Data_Either.Right) {
                                return new Data_Tuple.Tuple(function (v3) {
                                    return done(v2.value0, v2.value1.value0.value0.value0, v2.value1.value1);
                                }, v2.value1.value0.value0.value1);
                            };
                            throw new Error("Failed pattern match at Uncurried.StateT (line 137, column 15 - line 141, column 49): " + [ v2.value1.value0.constructor.name ]);
                        })));
                    };
                },
                Monoid0: function () {
                    return Monoid0;
                },
                MonadTell1: function () {
                    return monadTellStateT1;
                }
            };
        };
    };
};
var monadThrowStateT = function (dictMonadThrow) {
    return {
        throwError: (function () {
            var $215 = lift(dictMonadThrow.Monad0());
            var $216 = Control_Monad_Error_Class.throwError(dictMonadThrow);
            return function ($217) {
                return $215($216($217));
            };
        })(),
        Monad0: function () {
            return monadStateT;
        }
    };
};
var monadStateStateT = /* #__PURE__ */ Uncurried_RWSET.monadStateRWSET(Data_Monoid.monoidUnit);
var monadRecStateT = /* #__PURE__ */ Uncurried_RWSET.monadRecRWSET(Data_Monoid.monoidUnit);
var monadErrorStateT = function (dictMonadRec) {
    var runRWSET = Uncurried_RWSET.runRWSET(dictMonadRec);
    return function (dictMonadError) {
        var MonadThrow0 = dictMonadError.MonadThrow0();
        var mapFlipped = Data_Functor.mapFlipped((((MonadThrow0.Monad0()).Bind1()).Apply0()).Functor0());
        var catchError = Control_Monad_Error_Class.catchError(dictMonadError);
        var monadThrowStateT1 = monadThrowStateT(MonadThrow0);
        return {
            catchError: function (v) {
                return function (f) {
                    return function (environment, state, v1, lift$prime, error, done) {
                        return lift$prime(mapFlipped(catchError(runRWSET(environment)(state)(v))(function (e) {
                            var v2 = f(e);
                            return runRWSET(environment)(state)(v2);
                        }))(function (v2) {
                            return function (v3) {
                                if (v2.value1.value0 instanceof Data_Either.Left) {
                                    return error(v2.value0, v2.value1.value0.value0, v2.value1.value1);
                                };
                                if (v2.value1.value0 instanceof Data_Either.Right) {
                                    return done(v2.value0, v2.value1.value0.value0, v2.value1.value1);
                                };
                                throw new Error("Failed pattern match at Uncurried.StateT (line 159, column 17 - line 163, column 38): " + [ v2.value1.value0.constructor.name ]);
                            };
                        }));
                    };
                };
            },
            MonadThrow0: function () {
                return monadThrowStateT1;
            }
        };
    };
};
var monadEffectStateT = function (dictMonadEffect) {
    return monadEffectRWSET(dictMonadEffect);
};
var monadAskStateT = function (dictMonadAsk) {
    return {
        ask: lift(dictMonadAsk.Monad0())(Control_Monad_Reader_Class.ask(dictMonadAsk)),
        Monad0: function () {
            return monadStateT;
        }
    };
};
var monadReaderStateT = function (dictMonadRec) {
    var runRWSET = Uncurried_RWSET.runRWSET(dictMonadRec);
    return function (dictMonadReader) {
        var MonadAsk0 = dictMonadReader.MonadAsk0();
        var mapFlipped = Data_Functor.mapFlipped((((MonadAsk0.Monad0()).Bind1()).Apply0()).Functor0());
        var local = Control_Monad_Reader_Class.local(dictMonadReader);
        var monadAskStateT1 = monadAskStateT(MonadAsk0);
        return {
            local: function (f) {
                return function (v) {
                    return function (environment, state, v1, lift$prime, error, done) {
                        return lift$prime(mapFlipped(local(f)(runRWSET(environment)(state)(v)))(function (v2) {
                            return function (v3) {
                                if (v2.value1.value0 instanceof Data_Either.Left) {
                                    return error(v2.value0, v2.value1.value0.value0, v2.value1.value1);
                                };
                                if (v2.value1.value0 instanceof Data_Either.Right) {
                                    return done(v2.value0, v2.value1.value0.value0, v2.value1.value1);
                                };
                                throw new Error("Failed pattern match at Uncurried.StateT (line 109, column 15 - line 113, column 36): " + [ v2.value1.value0.constructor.name ]);
                            };
                        }));
                    };
                };
            },
            MonadAsk0: function () {
                return monadAskStateT1;
            }
        };
    };
};
var lazyStateT = /* #__PURE__ */ Uncurried_RWSET.lazyRWSET(Data_Monoid.monoidUnit);
var functorStateT = Uncurried_RWSET.functorRWSET;
var bindStateT = /* #__PURE__ */ Uncurried_RWSET.bindRWSET(Data_Monoid.monoidUnit);
var applyStateT = /* #__PURE__ */ Uncurried_RWSET.applyRWSET(Data_Monoid.monoidUnit);
var applicativeStateT = /* #__PURE__ */ Uncurried_RWSET.applicativeRWSET(Data_Monoid.monoidUnit);
var withStateT = function (f) {
    return function (v) {
        return function (environment, state, more, lift$prime, error, done) {
            return v(environment, f(state), more, lift$prime, error, done);
        };
    };
};
var stateT = function (dictFunctor) {
    var mapFlipped = Data_Functor.mapFlipped(dictFunctor);
    return function (k) {
        return function (v, state0, more, lift1, v1, done) {
            return more(function (v2) {
                return lift1(mapFlipped(k(state0))(function (v3) {
                    return function (v4) {
                        return done(v3.value1, v3.value0, Data_Unit.unit);
                    };
                }));
            });
        };
    };
};
var runStateT = function (dictMonadRec) {
    var map = Data_Functor.map((((dictMonadRec.Monad0()).Bind1()).Apply0()).Functor0());
    var runRWSET = Uncurried_RWSET.runRWSET(dictMonadRec);
    return function (s) {
        return function (v) {
            var go = function (v1) {
                if (v1.value1.value0 instanceof Data_Either.Left) {
                    return Data_Void.absurd(v1.value1.value0.value0);
                };
                if (v1.value1.value0 instanceof Data_Either.Right) {
                    return new Data_Tuple.Tuple(v1.value1.value0.value0, v1.value0);
                };
                throw new Error("Failed pattern match at Uncurried.StateT (line 41, column 5 - line 45, column 18): " + [ v1.value1.value0.constructor.name ]);
            };
            return map(go)(runRWSET(Data_Unit.unit)(s)(v));
        };
    };
};
var mapStateT = function (dictMonadRec) {
    var runStateT1 = runStateT(dictMonadRec);
    return function (dictFunctor) {
        var mapFlipped = Data_Functor.mapFlipped(dictFunctor);
        return function (f) {
            return function (k) {
                return function (v, state, v1, lift$prime, v2, done) {
                    return lift$prime(mapFlipped(f(runStateT1(state)(k)))(function (v3) {
                        return function (v4) {
                            return done(v3.value1, v3.value0, Data_Unit.unit);
                        };
                    }));
                };
            };
        };
    };
};
var hoistStateT = function (f) {
    return function (v) {
        return Uncurried_RWSET.hoistRWSET(f)(v);
    };
};
var execStateT = function (dictMonadRec) {
    var map = Data_Functor.map((((dictMonadRec.Monad0()).Bind1()).Apply0()).Functor0());
    var runStateT1 = runStateT(dictMonadRec);
    return function (s) {
        return function (k) {
            return map(Data_Tuple.snd)(runStateT1(s)(k));
        };
    };
};
var evalStateT = function (dictMonadRec) {
    var map = Data_Functor.map((((dictMonadRec.Monad0()).Bind1()).Apply0()).Functor0());
    var runStateT1 = runStateT(dictMonadRec);
    return function (s) {
        return function (k) {
            return map(Data_Tuple.fst)(runStateT1(s)(k));
        };
    };
};
export {
    StateT,
    stateT,
    runStateT,
    evalStateT,
    execStateT,
    hoistStateT,
    mapStateT,
    withStateT,
    functorStateT,
    applyStateT,
    applicativeStateT,
    bindStateT,
    monadStateT,
    monadEffectStateT,
    monadRecStateT,
    monadStateStateT,
    monadTransStateT,
    semigroupStateT,
    monoidStateT,
    lazyStateT,
    monadAskStateT,
    monadReaderStateT,
    monadTellStateT,
    monadWriterStateT,
    monadThrowStateT,
    monadErrorStateT
};
//# sourceMappingURL=index.js.map
